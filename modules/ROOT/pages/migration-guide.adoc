= Migration Guide

== From 2.0.0 to 2.1.5

* `{ "static": {} }` -> `{ "actions": {} }`
** jq '. + {"actions": .static} | del(.static)'

* `throughput_rate` -> `aps_rate`
** jq '. + {"aps_rate": .throughput_rate} | del(.throughput_rate)'

* Run Python script `convert_200_to_215.py`.

[source,python]
----
import json
from collections import OrderedDict
import sys

filename = sys.argv[1]
fh = open(filename)
jb = json.load(fh, object_pairs_hook=OrderedDict)

# Fix toplevel structure
jb_1 = OrderedDict()
jb_1["actions"] = jb["static"]
if "workflows" in jb_1["actions"].keys():
    jb_1["workflows"] = jb_1["actions"]["workflows"]
    del jb_1["actions"]["workflows"]
jb_1["benchmarks"] = jb["benchmarks"]
jb_1["contexts"] = jb["contexts"]

# Fix contexts
clist = jb_1["contexts"]
d = OrderedDict()
for e in clist:
    name = e["name"]
    del e["name"]
    d[name] = e
jb_1["contexts"] = d

# Fix benchmarks
blist = jb_1["benchmarks"]
d = OrderedDict()
for e in blist:
    name = e["name"]
    del e["name"]
    text = json.dumps(e)
    text = text.replace("throughput_rate", "aps_rate")
    text = text.replace("benchmark_repeat_count", "benchmark_iterations")
    text = text.replace("actions", "scenario_actions")
    text = text.replace("workflow", "scenario_workflow")
    e = json.loads(text)
    d[name] = e
jb_1["benchmarks"] = d

print(json.dumps(jb_1, indent=4))
----
